# 🚀 ماکرو-بنچمارک K6

یک سیستم کامل تست عملکرد و بنچمارک برای اندازه‌گیری عملکرد API ها با استفاده از K6.

## 📋 ویژگی‌ها

- **تست همزمانی**: 150 کاربر مجازی همزمان
- **تست چندگانه**: 10 بار اجرای متوالی برای دقت بیشتر
- **گزارش‌گیری HTML**: گزارش‌های  تعاملی
- **سه endpoint**: old, random, static
- **آمار کامل**: میانگین، min/max، P90، P95
- **تحلیل عملکرد**: مقایسه و تحلیل خودکار

## 🏗️ ساختار پروژه

```
bm/
├── 📁 k6_check/           # فایل‌های تست K6
│   ├── test_old.js        # تست endpoint قدیمی
│   ├── test_random.js     # تست endpoint تصادفی
│   ├── test_static.js     # تست endpoint ثابت
│   └── config.js          # تنظیمات مشترک
├── 📁 result/             # نتایج JSON
│   ├── results_old.json
│   ├── results_random.json
│   └── results_static.json
├── 📁 scripts/            # اسکریپت‌های کمکی
│   ├── generate_10_tests_report.js
│   ├── generate_html_report.js
│   ├── show_results.js
│   └── show_results_clean.js
├── 🎯 run_tests.js        # تست عادی (1 بار)
├── 🎯 run_10_tests.js     # تست 10 بار + گزارش HTML
├── 📄 test_report.html    # گزارش عادی
└── 📄 test_report_10_runs.html  # گزارش 10 بار
```

## 🚀 نحوه استفاده

### تست عادی (1 بار)
```bash
node run_tests.js
```

### تست 10 بار + گزارش HTML
```bash
node run_10_tests.js
```

## 📊 نتایج

### تست عادی
- **150 کاربر مجازی**
- **600 درخواست** برای هر endpoint
- **گزارش HTML** در `test_report.html`

### تست 10 بار
- **10 بار اجرا** برای دقت بیشتر
- **6000 درخواست** برای هر endpoint
- **گزارش HTML** در `test_report_10_runs.html`
- **تحلیل آماری** کامل

## 📈 آمار اندازه‌گیری

- **تعداد درخواست‌ها**
- **زمان پاسخ متوسط**
- **سریع‌ترین زمان**
- **کندترین زمان**
- **P90 و P95**
- **نرخ موفقیت**
- **تعداد خطاها**

## 🎨 گزارش‌های HTML

گزارش‌ها شامل:
- **جدول مقایسه** عملکرد
- **کارت‌های آماری** خلاصه
- **تحلیل عملکرد** خودکار
- **طراحی زیبا** و responsive
- **رنگ‌بندی فارسی** و RTL

## ⚙️ تنظیمات

فایل `k6_check/config.js`:
```javascript
export const config = {
  vus: 150,              // تعداد کاربران مجازی
  iterations: 600,       // تعداد درخواست‌ها
  maxDuration: '10m',    // حداکثر زمان
  gracefulStop: '30s'    // زمان توقف
};
```

## 🔧 پیش‌نیازها

- **Node.js** (نسخه 14 یا بالاتر)
- **K6** نصب شده
- **مرورگر** برای نمایش گزارش‌ها

## 📝 مثال خروجی

```
🎯 OLD:
   📈 کل درخواست‌ها: 6000
   ⏱️ میانگین زمان پاسخ: 1156ms
   🚀 سریع‌ترین: 17ms
   🐌 کندترین: 11050ms
   📊 90% درخواست‌ها: 5956ms

🌟 آمار کلی:
⏱️ زمان کل اجرا: 366 ثانیه
📈 کل درخواست‌ها: 18000
⚡ میانگین کلی زمان پاسخ: 1166ms
🔄 تعداد اجرا: 10 بار
```

## 🎯 هدف

این ماکرو-بنچمارک برای:
- **اندازه‌گیری عملکرد** API ها
- **مقایسه** endpoint های مختلف
- **تحلیل روند** عملکرد در زمان
- **شناسایی** مشکلات عملکرد
- **گزارش‌گیری** حرفه‌ای

## 📞 پشتیبانی

برای سوالات و مشکلات، لطفاً issues ایجاد کنید.

---

**توسعه یافته با ❤️ برای تست عملکرد حرفه‌ای**
